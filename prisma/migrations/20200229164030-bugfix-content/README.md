# Migration `20200229164030-bugfix-content`

This migration has been generated by Sajjad Shirazy at 2/29/2020, 4:40:30 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."Profile" (
    "bio" TEXT   ,
    "profile_id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "user" INTEGER NOT NULL  ,FOREIGN KEY ("user") REFERENCES "User"("user_id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_User" (
    "email" TEXT NOT NULL DEFAULT '' ,
    "name" TEXT   ,
    "user_id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT
) 

INSERT INTO "quaint"."new_User" ("email", "name") SELECT "email", "name" FROM "quaint"."User"

DROP TABLE "quaint"."User";

ALTER TABLE "quaint"."new_User" RENAME TO "User";

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Post" (
    "author" INTEGER   ,
    "content" TEXT   ,
    "post_id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "title" TEXT NOT NULL DEFAULT '' ,FOREIGN KEY ("author") REFERENCES "User"("user_id") ON DELETE SET NULL ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Post" ("author", "title") SELECT "author", "title" FROM "quaint"."Post"

DROP TABLE "quaint"."Post";

ALTER TABLE "quaint"."new_Post" RENAME TO "Post";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200229163507-init..20200229164030-bugfix-content
--- datamodel.dml
+++ datamodel.dml
@@ -2,32 +2,31 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
 }
-model User {
-  id        Int      @id
-  createdAt DateTime @default(now())
-  email     String   @unique
-  name      String?
-  role      Role     @default(USER)
-  posts     Post[]
+model Post {
+  post_id Int     @id @default(autoincrement())
+  content String?
+  title   String
+  author  User?
 }
-model Post {
-  id        Int      @id
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
-  author    User
-  title     String
-  published Boolean  @default(false)
+model Profile {
+  profile_id Int     @id @default(autoincrement())
+  bio        String?
+  user       User
 }
-enum Role {
-  USER ADMIN
+model User {
+  user_id  Int       @id @default(autoincrement())
+  email    String    @unique
+  name     String?
+  posts    Post[]
+  profiles Profile[]
 }
```


